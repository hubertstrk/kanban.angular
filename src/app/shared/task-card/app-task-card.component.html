<div class="flex bg-white dark:bg-zinc-600 rounded-lg mb-2 shadow-sm"
     (dblclick)="onEditTask()">
  <div [ngClass]="getPriorityClass()"></div>
  <div class="p-3 flex flex-col">
    <div class="flex">
      <div class="flex flex-col">
        <div [ngClass]="getTitleClass()">{{ task.title }}</div>
        <div [ngClass]="getDueAtClass()">{{ task.dueAt }}</div>
      </div>
      <app-button
        *ngIf="task.status === 'done'"
        (clicked)="onDeleteTask()"
        [size]="'sm'"
        [icon]="icons['fluent--delete-24-regular']">
      </app-button>
    </div>

    <div class="text-sm text-zinc-600 dark:text-zinc-300" (mousedown)="onTextMouseDown($event)"
    >{{ getTaskContent(task.content) }}
    </div>
  </div>
</div>

<app-modal [isOpen]="isModalOpen" (closed)="closeModal()">
  <div modalTitle>Edit Task</div>

  <div class="flex flex-col gap-4">
    <div class="flex flex-col gap-2">
      <label for="taskTitle" class="text-sm font-medium">Title</label>
      <input
        id="taskTitle"
        type="text"
        [(ngModel)]="editedTask.title"
        class="border border-gray-300 dark:border-gray-600 rounded-md p-2 dark:bg-zinc-700"
      >
    </div>

    <div class="flex flex-col gap-2">
      <label for="taskPriority" class="text-sm">Priority</label>
      <app-dropdown
        id="taskPriority"
        [options]="priorityOptions"
        [selectedValue]="editedTask.priority ?? TaskPriority.Medium"
        (selectionChange)="onPriorityChange($event)"
      ></app-dropdown>
    </div>

    <div class="flex flex-col gap-2">
      <label for="taskDueDate" class="text-sm">Due Date</label>
      <app-date-picker
        id="taskDueDate"
        [date]="editedTask.dueAt ?? null"
        (dateChange)="onDueDateChange($event)"
      ></app-date-picker>
    </div>

    <div class="flex flex-col gap-2">
      <label for="taskContent" class="text-sm">Description</label>
      <textarea
        id="taskContent"
        [(ngModel)]="editedTask.content"
        rows="6"
        class="border border-gray-300 dark:border-gray-600 rounded-md p-2 dark:bg-zinc-700"
        (mousedown)="onTextMouseDown($event)"
      ></textarea>
    </div>
  </div>

  <div modalFooter class="flex gap-2">
    <app-button (clicked)="closeModal()" [rounded]="false">
      <span class="px-2">Cancel</span>
    </app-button>
    <app-button (clicked)="saveTask()" [variant]="'secondary'" [rounded]="false">
      <span class="px-2">Save</span>
    </app-button>
  </div>
</app-modal>
